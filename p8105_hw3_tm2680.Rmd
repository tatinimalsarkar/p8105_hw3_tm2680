---
title: "p8105_hw3_tm2680"
author: "Tatini Mal-Sarkar"
date: "10/4/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
devtools::install_github("p8105/p8105.datasets")
library(ggridges)
```

# Problem 1
```{r brfss_clean}
library(p8105.datasets)
brfss_data = brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  filter(topic == "Overall Health") %>% 
  select(-class, -topic, -question, -data_value_footnote_symbol:-respid) %>% 
  mutate(response = factor(response, levels = c("Excellent", "Very good", "Good", "Fair", "Poor", ordered = TRUE))) 
```

```{r brfss_seven_loc}
brfss_data %>% 
  filter(year == 2002) %>% 
  group_by(locationabbr) %>% 
  summarize(n = n_distinct(geo_location)) %>% 
  filter(n >= 7)
```

In 2002, Connecticut, Florida, Massachusetts, North Carolina, New Jersey, and Pennsylvania were all observed at 7 distinct locations in the `brfss_data` dataset.

```{r brfss_spag_plot}
brfss_data %>% 
  group_by(locationabbr, year) %>% 
  mutate(n = n_distinct(geo_location)) %>% 
  ggplot(aes(x = year, y = n, color = locationabbr)) + 
  geom_line() + 
  theme(legend.position = "bottom")
```

Here is my spaghetti plot showing the number of locations across time for the `brfss_data` dataset. The colors correspond to state, and the data is from 2002 to 2010. 

```{r brfss_tab_exc}
brfss_data %>% 
  filter(locationabbr == "NY") %>% 
  group_by(locationdesc) %>% 
  spread(response, data_value) %>% 
  janitor::clean_names() %>% 
  filter(year == 2002 | year == 2006 | year == 2010) %>% 
  summarize(mean_exc = mean(excellent, na.rm = TRUE),
            sd_exc = sd(excellent, na.rm = TRUE)) 
```

This is my table that shows the mean and standard deviation for the proportion of "Excellent" responses across counties in New York. NA standard deviations mean that there was only 1 observation for that county.

```{r brfss_prop_resp}
brfss_data %>% 
  spread(response, data_value) %>% 
  janitor::clean_names() %>% 
  group_by(year, locationabbr, excellent, very_good, good, fair, poor) 
```

